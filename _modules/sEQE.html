<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sEQE &mdash; AFMDs sEQE setup October 2022 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/AFMD_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">sEQE-Control-Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licence.html">Licence</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AFMDs sEQE setup</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">sEQE</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sEQE</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Fri Sep 28 11:59:40 2018</span>

<span class="sd">@author: jungbluth</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">pathlib</span>

<span class="kn">import</span> <span class="nn">GUI_template</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">serial</span>
<span class="kn">import</span> <span class="nn">zhinst.utils</span>
<span class="kn">import</span> <span class="nn">zhinst.ziPython</span>
<span class="c1"># for the gui</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="kn">import</span> <span class="nn">codecs</span>

<span class="kn">from</span> <span class="nn">monochromator</span> <span class="kn">import</span> <span class="n">Monochromator</span>
<span class="kn">from</span> <span class="nn">microscope.filterwheels.thorlabs</span> <span class="kn">import</span> <span class="n">ThorlabsFilterWheel</span>
<span class="kn">from</span> <span class="nn">lockin</span> <span class="kn">import</span> <span class="n">LockIn</span>

<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span> 

<div class="viewcode-block" id="MainWindow"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow">[docs]</a><span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
         <span class="c1"># Initialising ports, device names and save path</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;pathsNdevices_config.txt&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">pNpdata</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">zurich_device</span> <span class="o">=</span> <span class="n">pNpdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filter_port</span> <span class="o">=</span> <span class="n">pNpdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mono_port</span> <span class="o">=</span>  <span class="n">pNpdata</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">=</span> <span class="n">pNpdata</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found the following details for setup in pathsNdevices.txt: </span><span class="se">\n</span><span class="s1"> zurich instrument device name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">zurich_device</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> second filter wheel port: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_port</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> monochromator port: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mono_port</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> default path where data are saved: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pNpdata</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">pNpdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty string in pathsNdevices.txt found. The current file will be deleted, please recreate the file&#39;</span><span class="p">)</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>  <span class="c1"># to delete file</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="n">exist_ok</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Linux&#39;</span><span class="p">:</span>
                <span class="n">port_prefix</span> <span class="o">=</span> <span class="s1">&#39;/dev/ttyUSB&#39;</span>
            <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span>
                <span class="n">port_prefix</span> <span class="o">=</span> <span class="s1">&#39;COM&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Operating System is not known - defaulting to Linux system&#39;</span><span class="p">)</span>
                <span class="n">port_prefix</span> <span class="o">=</span> <span class="s1">&#39;/dev/tty&#39;</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">zurich_device</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Which zurich instrument device is used  ? - type device address string e.g. UHF-DEV2000.  &#39;</span><span class="p">))</span> <span class="c1">#&#39;hf2-dev838&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filter_port</span> <span class="o">=</span> <span class="n">port_prefix</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Which port number is used by the second filter wheel ? - type a number  &#39;</span><span class="p">))</span><span class="c1"># AFMD default &#39;COM4&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mono_port</span> <span class="o">=</span>  <span class="n">port_prefix</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Which port number is used by the monochromator ? - type a number  &#39;</span><span class="p">))</span><span class="c1"># AFMD default &#39;COM1&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Where do you want to save your data ? - copy absolute path of folder  &#39;</span><span class="p">))</span><span class="c1"># AFMD default &#39;C:\\Users\\Public\\Documents\\sEQE&#39;</span>
            
            <span class="n">file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">zurich_device</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_port</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mono_port</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span>
        
        <span class="c1"># Set up the user interface from Designer</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">GUI_template</span><span class="o">.</span><span class="n">Ui_MainWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>         
        
        <span class="c1"># Connections</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mono_connected</span> <span class="o">=</span> <span class="kc">False</span>   <span class="c1"># Set the monochromator connection to False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lockin_connected</span> <span class="o">=</span> <span class="kc">False</span>   <span class="c1"># Set the Lock-in connection to False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_connected</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Set the filterwheel connection to False</span>
        
        <span class="c1"># Initialize Monochromator and Lock-In Amplifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mono</span> <span class="o">=</span> <span class="n">Monochromator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mono_port</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lockin</span> <span class="o">=</span> <span class="n">LockIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zurich_device</span><span class="p">)</span>
        
        <span class="c1"># General Setup</span>
         
        <span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">do_plot</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">complete_scan</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1"># these can not be defined here, due to empty text boxes at start up </span>
        <span class="c1"># self.userName = self.ui.user.text()</span>
        <span class="c1"># self.experimentName = self.ui.experiment.text()</span>
        <span class="c1"># self.path =f&#39;{self.save_path}/{self.userName}/{self.experimentName}&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="c1">####################################################################################</span>
        
        
        <span class="c1"># Handle Monochromator Buttons</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">connectButton_Mono</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectToMono</span><span class="p">)</span>  <span class="c1"># Connect only to Monochromator        </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">monoGotoButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleWavelengthButton</span><span class="p">)</span>   <span class="c1"># Go to specific wavelength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">monoSpeedButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">)</span>   <span class="c1"># Set scan speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">monoGratingButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleGratingButtons</span><span class="p">)</span>   <span class="c1"># Change grating    </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">monoFilterButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleFilterButton</span><span class="p">)</span>   <span class="c1"># Change filter</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">monoFilterInitButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleFilterInitButton</span><span class="p">)</span>   <span class="c1"># Initialize filter</span>
            
        <span class="c1"># Handle Lock-in Buttons</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">connectButton_Lockin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectToLockin</span><span class="p">)</span>   <span class="c1"># Connect only to Lock-in         </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">lockinParameterButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LockinHandleParameterButton</span><span class="p">)</span>   <span class="c1"># Set Lock-in parameters</span>

        <span class="c1"># Handle Filterwheel Buttons</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">connectButton_Filter</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectToFilter</span><span class="p">)</span> <span class="c1"># Connect only to Filterwheel</span>
         
        <span class="c1"># Handle Combined Buttons</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">connectButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectToEquipment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">completeScanButton_start</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleCompleteScanButton</span><span class="p">)</span>  <span class="c1">#########################################################################################</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">completeScanButton_stop</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HandleStopCompleteScanButton</span><span class="p">)</span>   <span class="c1">#########################################################################################</span>
        
        <span class="c1"># Save and Import data from files or naming from path</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">save_to_file</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_mono_parameter</span><span class="p">)</span> <span class="c1"># Save measurement parameter to file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">import_from_file</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_mono_parameter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">importNamingButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_naming</span><span class="p">)</span>
        
        
        <span class="c1"># Import photodiode calibration files</span>

        <span class="n">Si_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s2">&quot;FDS100-CAL.xlsx&quot;</span><span class="p">)</span> <span class="c1"># The files are in the sEQE Analysis folder</span>
<span class="c1">#        print(Si_file.sheet_names)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Si_cal</span> <span class="o">=</span> <span class="n">Si_file</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="c1">#        print(self.Si_cal)</span>
        
        <span class="n">InGaAs_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s2">&quot;FGA21-CAL.xlsx&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InGaAs_cal</span> <span class="o">=</span> <span class="n">InGaAs_file</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>     
        
    <span class="c1"># Close connection to Monochromator and Thorlabs filter wheel when window is closed</span>
    
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thorfilterwheel</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mono_port</span><span class="p">,</span> <span class="mi">9600</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span> 
        
        
<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>

    <span class="c1">#### Functions to import data into GUI</span>
    
<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>





<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>

    <span class="c1">#### Functions to connect to Monochromator and Lock-in</span>

<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>
        
    <span class="c1"># Establish serial connection to Monochromator</span>
    
<div class="viewcode-block" id="MainWindow.connectToMono"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.connectToMono">[docs]</a>    <span class="k">def</span> <span class="nf">connectToMono</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to establish connection to monochromator. </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mono_connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mono_connected</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Connection to Monochromator Established&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageConnect_mono</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of connectToMono function:&quot;</span><span class="p">)</span></div>
            
    <span class="c1"># Establish connection to LOCKIN</span>
    
<div class="viewcode-block" id="MainWindow.connectToLockin"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.connectToLockin">[docs]</a>    <span class="k">def</span> <span class="nf">connectToLockin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to establish connection to Lockin.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            Zurich Instruments localhost name and device details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockin_connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockin</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageConnect_lockin</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
        
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of connectToLockin function:&quot;</span><span class="p">)</span></div>
            
    <span class="c1"># Establish connection to Filterwheel</span>

<div class="viewcode-block" id="MainWindow.connectToFilter"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.connectToFilter">[docs]</a>    <span class="k">def</span> <span class="nf">connectToFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to establish connection to filter wheel.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thorfilterwheel</span> <span class="o">=</span> <span class="n">ThorlabsFilterWheel</span><span class="p">(</span><span class="n">com</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_port</span><span class="p">)</span> <span class="c1"># Initialize here = GUI openable without equipment physically connected</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorfilterwheel</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filter_connected</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connection to Thorlabs filter wheel established&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageConnect_filter</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s1">&#39;Could not find the Thorlabs filter wheel in position 1, i.e. in open position. Please check current filter wheel position manually.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filter_connected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of connectToFilter function:&quot;</span><span class="p">)</span></div>
<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>
        
    <span class="c1"># Establish connection to all equipment</span>
        
<div class="viewcode-block" id="MainWindow.connectToEquipment"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.connectToEquipment">[docs]</a>    <span class="k">def</span> <span class="nf">connectToEquipment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to establish connection to monochromator, Lockin &amp; filter wheel.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connectToLockin</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connectToMono</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connectToFilter</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageConnect</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of connectToEquipment function:&quot;</span><span class="p">)</span></div>
    
<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>
    
    <span class="c1">#### Functions to handle parameter buttons for Monochromator and Lock-in</span>
    
<span class="c1"># -----------------------------------------------------------------------------------------------------------            </span>
       
    <span class="c1">## Monochromator Functions</span>
    
    <span class="c1"># Set and GOTO wavelength</span>
    
<div class="viewcode-block" id="MainWindow.MonoHandleWavelengthButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.MonoHandleWavelengthButton">[docs]</a>    <span class="k">def</span> <span class="nf">MonoHandleWavelengthButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>   <span class="c1"># Function sets desired wavelength and calls chooseWavelength function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to read wavelength value from GUI.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickNM</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseWavelength</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span></div>
      
    <span class="c1"># Update the scan speed</span>
            
<div class="viewcode-block" id="MainWindow.MonoHandleSpeedButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.MonoHandleSpeedButton">[docs]</a>    <span class="k">def</span> <span class="nf">MonoHandleSpeedButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>   <span class="c1"># Function sets desired scan speed and calls chooseScanSpeed function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to read monochromator speed from GUI.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickScanSpeed</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseScanSpeed</span><span class="p">(</span><span class="n">speed</span><span class="p">)</span></div>

    <span class="c1"># Set and move to grating </span>
    
<div class="viewcode-block" id="MainWindow.MonoHandleGratingButtons"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.MonoHandleGratingButtons">[docs]</a>    <span class="k">def</span> <span class="nf">MonoHandleGratingButtons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>   <span class="c1"># Function sets desired grating number and calls chooseGrating function</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to read grating number from monochromator.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Blaze_300</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">gratingNo</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Blaze_750</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">gratingNo</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">Blaze_1600</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">gratingNo</span> <span class="o">=</span> <span class="mi">3</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseGrating</span><span class="p">(</span><span class="n">gratingNo</span><span class="p">)</span></div>
       
    <span class="c1"># Update filter number</span>
            
<div class="viewcode-block" id="MainWindow.MonoHandleFilterButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.MonoHandleFilterButton">[docs]</a>    <span class="k">def</span> <span class="nf">MonoHandleFilterButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to read filter position from GUI.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filterNo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickFilter</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseFilter</span><span class="p">(</span><span class="n">filterNo</span><span class="p">)</span></div>

    <span class="c1"># Initialize filter </span>

<div class="viewcode-block" id="MainWindow.MonoHandleFilterInitButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.MonoHandleFilterInitButton">[docs]</a>    <span class="k">def</span> <span class="nf">MonoHandleFilterInitButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to read filter initialization position from GUI.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filterStart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickFilterInitStart</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">filterDiff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="n">filterStart</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">initializeFilter</span><span class="p">(</span><span class="n">filterDiff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageInit_filterwheel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Monochromator Filter Wheel initialized&#39;</span><span class="p">)</span> </div>
    
<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>
    
    <span class="c1">## Lock-in Functions</span>
    
    <span class="c1"># Define and set Lock-in parameters</span>
    
<div class="viewcode-block" id="MainWindow.LockinHandleParameterButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.LockinHandleParameterButton">[docs]</a>    <span class="k">def</span> <span class="nf">LockinHandleParameterButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to read Lockin amplification value from GUI.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockin_connected</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickAmp</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Lock-In not connected&#39;</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of LockinHandleParametersButton function:&quot;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="MainWindow.LockinUpdateParameters"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.LockinUpdateParameters">[docs]</a>    <span class="k">def</span> <span class="nf">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">amplification</span><span class="p">):</span>   <span class="c1"># Function sets desired Lock-in parameters and calls setParameter function </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to update Lockin parameters.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amplification int, required</span>
<span class="sd">            amplification value of the LockIn signal</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LoggerError</span>
<span class="sd">            Raises error if Lockin not connected or Exception handling</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockin_connected</span><span class="p">:</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">c_2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="p">)</span> <span class="c1"># Channel 2, with value 1, for the reference input</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickTC</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="c1"># Import value for time constant</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickDTR</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="c1"># Import value for data transfer rate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lowpass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">pickLPFO</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="c1"># Import value for low pass filter order</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># This sets the default voltage range to 2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ac</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># AC off</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">imp50</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># 50 Ohm off</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">imp50_2</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Turn on 50 Ohm on channel 2 to attenuate signal from chopper controller as reference signal</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diff</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Diff off</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">diff_2</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#diff for channel 2 off</span>
    <span class="c1">#            if self.ui.acButton.isChecked(): # AC on if button is checked</span>
    <span class="c1">#                self.ac = 1</span>
    <span class="c1">#            if self.ui.imp50Button.isChecked(): # 50 Ohm on if button is checked</span>
    <span class="c1">#                self.imp50 = 1</span>
    <span class="c1">#            if self.ui.diffButton.isChecked(): # Diff on if button is checked</span>
    <span class="c1">#                self.diff = 1                </span>
    <span class="c1">#            self.frequency = self.ui.pickFreq.value() # For manual frequency control. The frequency tab is currently not implemented in the GUI</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">lockin</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diff_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">diff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imp50</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imp50_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ac</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lowpass</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_2</span><span class="p">,</span> <span class="n">amplification</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Updating Lock-In Settings&#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Lock-In not connected&quot;</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of LockinUpdateParameters function:&quot;</span><span class="p">)</span></div>
             
        
<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>
    
    <span class="c1">#### Functions to handle filter and grating changes</span>

<span class="c1"># -----------------------------------------------------------------------------------------------------------  </span>
  
        
<div class="viewcode-block" id="MainWindow.monoCheckFilter"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.monoCheckFilter">[docs]</a>    <span class="k">def</span> <span class="nf">monoCheckFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>   <span class="c1"># Filter switching points from GUI</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to update position of first filter wheel from GUI defaults.</span>
<span class="sd">            </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength: float, required</span>
<span class="sd">            Current wavelength position of monochromator</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LoggerError</span>
<span class="sd">            Raises error if filter wheel commands are invalid or monochromator not connected</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filterNo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">checkFilter</span><span class="p">()</span>

        <span class="n">startNM_F2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_F2</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_F2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_F2</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>                
        <span class="n">startNM_F3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_F3</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_F3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_F3</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">startNM_F4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_F4</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_F4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_F4</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">startNM_F5</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_F5</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_F5</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_F5</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>            

        <span class="k">if</span> <span class="n">startNM_F2</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;</span> <span class="n">stopNM_F2</span><span class="p">:</span> <span class="c1"># Filter 3 [FESH0700]: from 350 - 649  -- including start, excluing end</span>
            <span class="n">shouldbeFilterNo</span> <span class="o">=</span> <span class="mi">2</span>                  
        <span class="k">elif</span> <span class="n">startNM_F3</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;</span> <span class="n">stopNM_F3</span><span class="p">:</span> <span class="c1"># Filter 3 [FESH0700]: from 350 - 649  -- including start, excluing end</span>
            <span class="n">shouldbeFilterNo</span> <span class="o">=</span> <span class="mi">3</span>  
        <span class="k">elif</span> <span class="n">startNM_F4</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;</span> <span class="n">stopNM_F4</span><span class="p">:</span> <span class="c1"># Filter 4 [FESH1000]: from 650 - 984  -- including start, excluding end</span>
            <span class="n">shouldbeFilterNo</span> <span class="o">=</span> <span class="mi">4</span> 
        <span class="k">elif</span> <span class="n">startNM_F5</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;=</span> <span class="n">stopNM_F5</span><span class="p">:</span> <span class="c1"># Filter 5 [FELH0950]: from 985 - 1800  -- including start, including end</span>
            <span class="n">shouldbeFilterNo</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>   
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error: Filter Out Of Range&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shouldbeFilterNo</span> <span class="o">!=</span> <span class="n">filterNo</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseFilter</span><span class="p">(</span><span class="n">shouldbeFilterNo</span><span class="p">)</span>    


            <span class="c1"># Take data and discard it, this is required to avoid kinks</span>
            <span class="c1"># Poll data for 5 time constants, second parameter is poll timeout in [ms] (recomended value is 500ms) </span>
            <span class="n">dataDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>  
            <span class="c1"># Dictionary with [&#39;timestamp&#39;][&#39;x&#39;][&#39;y&#39;][&#39;frequency&#39;][&#39;phase&#39;][&#39;dio&#39;][&#39;trigger&#39;][&#39;auxin0&#39;][&#39;auxin1&#39;][&#39;time&#39;]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>
    
<div class="viewcode-block" id="MainWindow.monoCheckGrating"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.monoCheckGrating">[docs]</a>    <span class="k">def</span> <span class="nf">monoCheckGrating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>   <span class="c1"># Grating switching points from GUI</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to update monochromator grating position from GUI defaults.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        wavelength: float, required</span>
<span class="sd">            Current wavelength position of monochromator</span>

<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LoggerError</span>
<span class="sd">            Raises error if grating commands are invalid or monochromator not connected</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gratingNo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">checkGrating</span><span class="p">()</span>
        
        <span class="n">startNM_G1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_G1</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_G1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_G1</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">startNM_G2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_G2</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_G2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_G2</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">startNM_G3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">startNM_G3</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">stopNM_G3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">stopNM_G3</span><span class="o">.</span><span class="n">value</span><span class="p">())</span> 

        <span class="k">if</span> <span class="n">startNM_G1</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;</span> <span class="n">stopNM_G1</span><span class="p">:</span> <span class="c1"># Grating 1: from 350 - 549  -- including start, excluding end</span>
            <span class="n">shouldbeGratingNo</span> <span class="o">=</span> <span class="mi">1</span>  
        <span class="k">elif</span> <span class="n">startNM_G2</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;</span> <span class="n">stopNM_G2</span><span class="p">:</span> <span class="c1"># Grating 2: from 550 - 1299  -- including start, excluding end</span>
            <span class="n">shouldbeGratingNo</span> <span class="o">=</span> <span class="mi">2</span>  
        <span class="k">elif</span> <span class="n">startNM_G3</span> <span class="o">&lt;=</span> <span class="n">wavelength</span> <span class="o">&lt;=</span> <span class="n">stopNM_G3</span><span class="p">:</span> <span class="c1"># Grating 3: from 1300 - 1800  -- including start, including end</span>
            <span class="n">shouldbeGratingNo</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c1"># Do I need this?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error: Grating Out Of Range&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shouldbeGratingNo</span> <span class="o">!=</span> <span class="n">gratingNo</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseGrating</span><span class="p">(</span><span class="n">shouldbeGratingNo</span><span class="p">)</span>

            <span class="c1"># Take data and discard it, this is required to avoid kinks                </span>
            <span class="c1"># Poll data for 5 time constants, second parameter is poll timeout in [ms] (recomended value is 500ms) </span>
            <span class="n">dataDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>  
            <span class="c1"># Dictionary with [&#39;timestamp&#39;][&#39;x&#39;][&#39;y&#39;][&#39;frequency&#39;][&#39;phase&#39;][&#39;dio&#39;][&#39;trigger&#39;][&#39;auxin0&#39;][&#39;auxin1&#39;][&#39;time&#39;]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>

<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>

    <span class="c1">#### Function to handle filter changes of Thorlabs filter wheel</span>

<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="MainWindow.thorChangeFilter"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.thorChangeFilter">[docs]</a>    <span class="k">def</span> <span class="nf">thorChangeFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to update position of second filter wheel.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pos: int, required</span>
<span class="sd">            Target filter position, between 1-6</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if connection to second filter wheel is successful, False otherwise</span>
<span class="sd">            </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LoggerError</span>
<span class="sd">            Raises error if second filter wheel not connected</span>
<span class="sd">       </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_connected</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;External Filter Wheel Not Connected&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">thorfilterwheel</span><span class="o">.</span><span class="n">_do_set_position</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># -1 due to microscope.thorfilterwheel code accepting only 0-5</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Thorlabs filterwheel moved to </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s1">. position&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of thorChangeFilter function:&quot;</span><span class="p">)</span></div>
        
<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>
    
    <span class="c1">#### Functions to handle measurement parameter and measurment itself</span>
    
<span class="c1"># -----------------------------------------------------------------------------------------------------------  </span>

<div class="viewcode-block" id="MainWindow.MonoHandleCompleteScanButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.MonoHandleCompleteScanButton">[docs]</a>    <span class="k">def</span> <span class="nf">MonoHandleCompleteScanButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to measure samples with different filters.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">complete_scan</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageCompleteScan_start</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
            <span class="n">measurement_values</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_noFilter</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to Open Filter Position&#39;</span><span class="p">)</span>

                    <span class="n">start_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">stop_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">step_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">amp_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                    <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f1</span><span class="p">,</span><span class="n">stop_f1</span><span class="p">,</span><span class="n">step_f1</span><span class="p">,</span><span class="n">amp_f1</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="n">amp_f1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">()</span> 

                    <span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createScanJob</span><span class="p">(</span><span class="n">start_f1</span><span class="p">,</span> <span class="n">stop_f1</span><span class="p">,</span> <span class="n">step_f1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HandleMeasurement</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">start_f1</span><span class="p">,</span> <span class="n">stop_f1</span><span class="p">,</span> <span class="n">step_f1</span><span class="p">,</span> <span class="n">amp_f1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter2</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cuton_filter_2</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to </span><span class="si">%s</span><span class="s1"> nm Filter&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span><span class="p">)</span>

                    <span class="n">start_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">stop_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">step_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">amp_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                    <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f2</span><span class="p">,</span><span class="n">stop_f2</span><span class="p">,</span><span class="n">step_f2</span><span class="p">,</span><span class="n">amp_f2</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="n">amp_f2</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">()</span>

                    <span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createScanJob</span><span class="p">(</span><span class="n">start_f2</span><span class="p">,</span> <span class="n">stop_f2</span><span class="p">,</span> <span class="n">step_f2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HandleMeasurement</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">start_f2</span><span class="p">,</span> <span class="n">stop_f2</span><span class="p">,</span> <span class="n">step_f2</span><span class="p">,</span> <span class="n">amp_f2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter3</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cuton_filter_3</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to </span><span class="si">%s</span><span class="s1"> nm Filter&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span><span class="p">)</span>

                    <span class="n">start_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">stop_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">step_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">amp_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                    <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f3&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f3</span><span class="p">,</span><span class="n">stop_f3</span><span class="p">,</span><span class="n">step_f3</span><span class="p">,</span><span class="n">amp_f3</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="n">amp_f3</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">()</span>

                    <span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createScanJob</span><span class="p">(</span><span class="n">start_f3</span><span class="p">,</span> <span class="n">stop_f3</span><span class="p">,</span> <span class="n">step_f3</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HandleMeasurement</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">start_f3</span><span class="p">,</span> <span class="n">stop_f3</span><span class="p">,</span> <span class="n">step_f3</span><span class="p">,</span> <span class="n">amp_f3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter4</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cuton_filter_4</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to </span><span class="si">%s</span><span class="s1"> nm Filter&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span><span class="p">)</span>

                    <span class="n">start_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">stop_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">step_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">amp_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                    <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f4&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f4</span><span class="p">,</span><span class="n">stop_f4</span><span class="p">,</span><span class="n">step_f4</span><span class="p">,</span><span class="n">amp_f4</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="n">amp_f4</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">()</span>

                    <span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createScanJob</span><span class="p">(</span><span class="n">start_f4</span><span class="p">,</span> <span class="n">stop_f4</span><span class="p">,</span> <span class="n">step_f4</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HandleMeasurement</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">start_f4</span><span class="p">,</span> <span class="n">stop_f4</span><span class="p">,</span> <span class="n">step_f4</span><span class="p">,</span> <span class="n">amp_f4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter5</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cuton_filter_5</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to </span><span class="si">%s</span><span class="s1"> nm Filter&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span><span class="p">)</span>

                    <span class="n">start_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">stop_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">step_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">amp_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                    <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f5&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f5</span><span class="p">,</span><span class="n">stop_f5</span><span class="p">,</span><span class="n">step_f5</span><span class="p">,</span><span class="n">amp_f5</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="n">amp_f5</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">()</span>

                    <span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createScanJob</span><span class="p">(</span><span class="n">start_f5</span><span class="p">,</span> <span class="n">stop_f5</span><span class="p">,</span> <span class="n">step_f5</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HandleMeasurement</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">start_f5</span><span class="p">,</span> <span class="n">stop_f5</span><span class="p">,</span> <span class="n">step_f5</span><span class="p">,</span> <span class="n">amp_f5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter6</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">cuton_filter_6</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to </span><span class="si">%s</span><span class="s1"> nm Filter&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span><span class="p">)</span>

                    <span class="n">start_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">stop_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">step_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                    <span class="n">amp_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                    <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f6&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f6</span><span class="p">,</span><span class="n">stop_f6</span><span class="p">,</span><span class="n">step_f6</span><span class="p">,</span><span class="n">amp_f6</span><span class="p">]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span> <span class="o">=</span> <span class="n">amp_f6</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LockinUpdateParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MonoHandleSpeedButton</span><span class="p">()</span>

                    <span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createScanJob</span><span class="p">(</span><span class="n">start_f6</span><span class="p">,</span> <span class="n">stop_f6</span><span class="p">,</span> <span class="n">step_f6</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HandleMeasurement</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">start_f6</span><span class="p">,</span> <span class="n">stop_f6</span><span class="p">,</span> <span class="n">step_f6</span><span class="p">,</span> <span class="n">amp_f6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">thorChangeFilter</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Moving to open filter&#39;</span><span class="p">)</span>               
            <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseFilter</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">complete_scan</span> <span class="o">=</span> <span class="kc">False</span>   
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageCompleteScan_start</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_off.png&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageCompleteScan_stop</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_off.png&quot;</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finished Measurement&#39;</span><span class="p">)</span> 

            <span class="n">measurement_parameter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">measurement_values</span><span class="p">)</span>
                    <span class="c1">#self.save(measurement_values)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of MonoHandleCompleteScanButton function:&quot;</span><span class="p">)</span></div>
            
            
<div class="viewcode-block" id="MainWindow.load_naming"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.load_naming">[docs]</a>    <span class="k">def</span> <span class="nf">load_naming</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to load naming from directory path</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>
            
            <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span> <span class="c1"># Creates master window for tkinters filedialog window</span>
            <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span> <span class="c1"># Hides master window</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">()</span> <span class="c1"># Creates pop-up window to ask for file save</span>
            
            <span class="n">names</span> <span class="o">=</span> <span class="n">filepath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of load_naming function:&quot;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MainWindow.save_mono_parameter"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.save_mono_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">save_mono_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to save monochromator measurement parameters to file</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        LoggerWarning</span>
<span class="sd">            Raises warning if tkinter saving dialog was closed without entering filename</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Reads the spinbox values and saves them into a file selected via tkinter dialog</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>

            <span class="n">measurement_values</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_noFilter</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="n">start_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">stop_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">step_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">amp_f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_1</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f1</span><span class="p">,</span><span class="n">stop_f1</span><span class="p">,</span><span class="n">step_f1</span><span class="p">,</span><span class="n">amp_f1</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter2</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="n">start_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">stop_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">step_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">amp_f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_2</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f2</span><span class="p">,</span><span class="n">stop_f2</span><span class="p">,</span><span class="n">step_f2</span><span class="p">,</span><span class="n">amp_f2</span><span class="p">]</span>


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter3</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="n">start_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">stop_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">step_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">amp_f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f3&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f3</span><span class="p">,</span><span class="n">stop_f3</span><span class="p">,</span><span class="n">step_f3</span><span class="p">,</span><span class="n">amp_f3</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter4</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="n">start_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">stop_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">step_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">amp_f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_4</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f4&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f4</span><span class="p">,</span><span class="n">stop_f4</span><span class="p">,</span><span class="n">step_f4</span><span class="p">,</span><span class="n">amp_f4</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter5</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="n">start_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">stop_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">step_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">amp_f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_5</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f5&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f5</span><span class="p">,</span><span class="n">stop_f5</span><span class="p">,</span><span class="n">step_f5</span><span class="p">,</span><span class="n">amp_f5</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter6</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="n">start_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">stop_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">step_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                <span class="n">amp_f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_6</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

                <span class="n">measurement_values</span><span class="p">[</span><span class="s1">&#39;f6&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">start_f6</span><span class="p">,</span><span class="n">stop_f6</span><span class="p">,</span><span class="n">step_f6</span><span class="p">,</span><span class="n">amp_f6</span><span class="p">]</span>

            <span class="n">measurement_parameter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">measurement_values</span><span class="p">)</span>

            <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span> <span class="c1"># Creates master window for tkinters filedialog window</span>
            <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span> <span class="c1"># Hides master window</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">()</span> <span class="c1"># Creates pop-up window to ask for file save</span>

            <span class="c1"># This somehow destroys the Qt event manager, error message: </span>
            <span class="c1"># &quot;QCoreApplication::exec: The event loop is already running&quot;</span>
            <span class="c1"># self.filename = str(input(&#39;What is the name of this measurement routine ?:  &#39;))</span>
            <span class="c1"># if self.path.exists() not:</span>
            <span class="c1">#     os. </span>

            <span class="n">measurement_parameter</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Saved measurement parameter into: &#39;</span><span class="o">+</span> <span class="n">filepath</span><span class="p">)</span> 
        
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;No parameters were safed due to missing filename&#39;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of save_mono_parameter function:&quot;</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="MainWindow.load_mono_parameter"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.load_mono_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">load_mono_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to load monochromator measurement parameters from file.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Selects a file via tkinter dialog, reads the values and sets measurement parameters</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span> <span class="c1"># Creates master window for tkinters filedialog window</span>
            <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span> <span class="c1"># Hides master window</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">()</span> <span class="c1"># Creates pop-up window to ask for file save</span>

            <span class="n">measurement_parameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_noFilter</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_1</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_1</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_1</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_1</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter2</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_2</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_2</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_2</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_2</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f2&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>                

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter3</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_3</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f3&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_3</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f3&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_3</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f3&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_3</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f3&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter4</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_4</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f4&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_4</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f4&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_4</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f4&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_4</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f4&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter5</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_5</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f5&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_5</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f5&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_5</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f5&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_5</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f5&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_Filter6</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_startNM_6</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f6&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stopNM_6</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f6&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_stepNM_6</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f6&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">scan_pickAmp_6</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">measurement_parameters</span><span class="p">[</span><span class="s1">&#39;f6&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during execution of load_mono_parameter function:&quot;</span><span class="p">)</span></div>
        
        
    <span class="c1"># General function to create scanning list</span>
        
<div class="viewcode-block" id="MainWindow.createScanJob"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.createScanJob">[docs]</a>    <span class="k">def</span> <span class="nf">createScanJob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to compile scan parameters.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start: float, required</span>
<span class="sd">            Wavelength start value</span>
<span class="sd">        stop: float, required</span>
<span class="sd">            Wavelength stop value</span>
<span class="sd">        step: float, required</span>
<span class="sd">            Wavelength step value</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            List of integer wavelength values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scan_list</span> <span class="o">=</span> <span class="p">[]</span>       
        <span class="n">number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">stop</span><span class="o">-</span><span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="n">step</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> 
        <span class="c1"># -1 to start from before the beginning, +1 to include the last iteration of &#39;number&#39;, [and +2 to go above stop (this can</span>
        <span class="c1"># be changed later])</span>
            <span class="n">wavelength</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">step</span>
            <span class="n">scan_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">scan_list</span></div>
           
<span class="c1"># -----------------------------------------------------------------------------------------------------------        </span>
    
    <span class="c1">#### Functions to handle measurement</span>

<span class="c1"># -----------------------------------------------------------------------------------------------------------       </span>
        
    <span class="c1"># Measure LOCKIN response    </span>
     
<div class="viewcode-block" id="MainWindow.HandleMeasurement"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.HandleMeasurement">[docs]</a>    <span class="k">def</span> <span class="nf">HandleMeasurement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_list</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>  
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to prepare sample measurement.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scan_list: list of ints, required</span>
<span class="sd">            List of wavelength values to scan</span>
<span class="sd">        start: float, required</span>
<span class="sd">            Wavelength start value</span>
<span class="sd">        stop: float, required</span>
<span class="sd">            Wavelength stop value</span>
<span class="sd">        step: float, required</span>
<span class="sd">            Wavelength step value</span>
<span class="sd">        amp: float, required</span>
<span class="sd">            Pre-amplifier amplification value</span>
<span class="sd">        number: int, required</span>
<span class="sd">            Specifier to decide if power value is calculated (1) or not (0)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>      
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mono_connected</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockin_connected</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_connected</span><span class="p">:</span>   
            <span class="c1"># Assign user, expriment and file name for current measurement</span>
            <span class="n">userName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">experimentName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            
            <span class="n">start_no</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">))</span>
            <span class="n">stop_no</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">stop</span><span class="p">))</span>
            <span class="n">step_no</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">step</span><span class="p">))</span>
            <span class="n">amp_no</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">amp</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="c1">#                name = &#39;Si_ref_diode&#39;</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>  
            <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="c1">#                name = &#39;InGaAs_ref_diode&#39;</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>  
            <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_scan</span><span class="p">:</span> <span class="c1"># If not a complete scan is taken</span>
                <span class="n">fileName</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_(&#39;</span> <span class="o">+</span> <span class="n">start_no</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">stop_no</span> <span class="o">+</span> <span class="s1">&#39;nm_&#39;</span> <span class="o">+</span> <span class="n">step_no</span> <span class="o">+</span> <span class="s1">&#39;nm_&#39;</span> <span class="o">+</span> <span class="n">amp_no</span> <span class="o">+</span> <span class="s1">&#39;x)&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_scan</span><span class="p">:</span>
                <span class="n">fileName</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_addition</span> <span class="o">+</span> <span class="s1">&#39;Filter&#39;</span> <span class="o">+</span> <span class="s1">&#39;_(&#39;</span> <span class="o">+</span> <span class="n">start_no</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">stop_no</span> <span class="o">+</span> <span class="s1">&#39;nm_&#39;</span> <span class="o">+</span> <span class="n">step_no</span> <span class="o">+</span> <span class="s1">&#39;nm_&#39;</span> <span class="o">+</span> <span class="n">amp_no</span> <span class="o">+</span> <span class="s1">&#39;x)&#39;</span> 
        
            <span class="c1">#Set up path to save data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">userName</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">experimentName</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saving data to: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>       
            <span class="bp">self</span><span class="o">.</span><span class="n">naming</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># This function defines a variable called self.file_name</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">scan_list</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span></div>
            
            
         
         
<div class="viewcode-block" id="MainWindow.measure"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.measure">[docs]</a>    <span class="k">def</span> <span class="nf">measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_list</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>     
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to perform sample measurement.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scan_list: list of ints, required</span>
<span class="sd">            List of wavelength values to scan</span>
<span class="sd">        number: int, required</span>
<span class="sd">            Specifier to decide if power value is calculated (1) or not (0)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">#        columns = [&#39;Wavelength&#39;, &#39;Mean Current&#39;, &#39;Amplification&#39;, &#39;Mean R&#39;, &#39;Log Mean R&#39;, &#39;Mean RMS&#39;, &#39;Mean X&#39;, &#39;Mean Y&#39;, &#39;Mean Frequency&#39;, &#39;Mean Phase&#39;]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Current&#39;</span><span class="p">,</span> <span class="s1">&#39;Amplification&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean R&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Phase&#39;</span><span class="p">]</span>    
        
        <span class="bp">self</span><span class="o">.</span><span class="n">measuring</span> <span class="o">=</span> <span class="kc">True</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageCompleteScan_stop</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_off.png&quot;</span><span class="p">))</span>
        
        <span class="c1"># Set up plot style                </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_plot</span><span class="p">:</span>
<span class="c1">#            plt.close()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_up_plot</span><span class="p">()</span>
            
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Set up empty lists for measurements</span>
        <span class="n">plot_list_x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plot_list_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plot_log_list_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plot_list_phase</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span> 
                    
        <span class="c1"># Subscribe to scope</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path0</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">+</span> <span class="s1">&#39;/demods/&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span><span class="s1">&#39;/sample&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path0</span><span class="p">)</span> 
        
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        
<span class="c1">#        self.chooseFilter(2)</span>


        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">scan_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measuring</span><span class="p">:</span>                
                <span class="n">wavelength</span> <span class="o">=</span> <span class="n">scan_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">monoCheckFilter</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">monoCheckGrating</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">mono</span><span class="o">.</span><span class="n">chooseWavelength</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
                
                <span class="c1"># Poll data for 5 time constants, second parameter is poll timeout in [ms] (recomended value is 500ms) </span>
                <span class="n">dataDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># Dictionary with [&#39;timestamp&#39;][&#39;x&#39;][&#39;y&#39;][&#39;frequency&#39;][&#39;phase&#39;][&#39;dio&#39;][&#39;trigger&#39;][&#39;auxin0&#39;][&#39;auxin1&#39;][&#39;time&#39;]</span>
<span class="c1">#                print(dataDict[self.device][&#39;demods&#39;][self.c][&#39;sample&#39;][&#39;timestamp&#39;])</span>
                
            
                <span class="c1"># Recreate data</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="ow">in</span> <span class="n">dataDict</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">dataDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">][</span><span class="s1">&#39;demods&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="s1">&#39;dataloss&#39;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Sample Loss Detected&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">count</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># Cut off the first measurement before the start to cut off the initial spike in the spectrum                         </span>
<span class="c1">#                           if self.imp50==0:     #### FIX THIS TO HANDLE IMP 50</span>
<span class="c1">#                                e = amp_coeff*amplitude/sqrt(2)</span>
<span class="c1">#                           elif self.imp50==1:  # If 50 Ohm impedance is enabled, the signal is cut in half</span>
<span class="c1">#                                e = 0.5*amp_coeff*amplitude/sqrt(2) </span>
                            
                            <span class="n">data</span> <span class="o">=</span> <span class="n">dataDict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">][</span><span class="s1">&#39;demods&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span>
                            <span class="n">rdata</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                            <span class="n">rms</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                            <span class="n">current</span> <span class="o">=</span> <span class="n">rdata</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">amplification</span>
                            
                            <span class="n">mean_curr</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                            <span class="n">mean_r</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">rdata</span><span class="p">)</span>
                            <span class="n">log_mean_r</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">mean_r</span><span class="p">)</span>
                            <span class="n">mean_rms</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">rms</span><span class="p">)</span>
                            <span class="n">mean_x</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
                            <span class="n">mean_y</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
                            <span class="n">mean_freq</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">])</span>
                            <span class="n">mean_phase</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">])</span>
                                                                                         
                            
<span class="c1">#                            scanValues = [wavelength, mean_curr, self.amplification, mean_r, log_mean_r, mean_rms, mean_x, mean_y, mean_freq, mean_phase]</span>
                            <span class="n">scanValues</span> <span class="o">=</span> <span class="p">[</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">mean_curr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplification</span><span class="p">,</span> <span class="n">mean_r</span><span class="p">,</span> <span class="n">mean_freq</span><span class="p">,</span> <span class="n">mean_phase</span><span class="p">]</span>
                           
                            <span class="n">plot_list_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
                            <span class="n">plot_list_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_r</span><span class="p">)</span>
                            <span class="n">plot_log_list_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_mean_r</span><span class="p">)</span>
                            <span class="n">plot_list_phase</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_phase</span><span class="p">)</span>
        
                            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scanValues</span><span class="p">)</span>
                            
                            <span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">calculatePower</span><span class="p">(</span><span class="n">data_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Si_cal</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">calculatePower</span><span class="p">(</span><span class="n">data_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">InGaAs_cal</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span> <span class="c1">#### CHECK THAT THIS WORKS!!!</span>
                                <span class="k">pass</span>
                            
                            <span class="n">data_file</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
                            
                            
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_plot</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_list_x</span><span class="p">,</span> <span class="n">plot_list_y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_list_x</span><span class="p">,</span> <span class="n">plot_log_list_y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_list_x</span><span class="p">,</span> <span class="n">plot_list_phase</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
                                
                <span class="k">del</span> <span class="n">scan_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>  
                
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageCompleteScan_stop</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
                <span class="k">break</span>
        

        <span class="c1"># Unsubscribe to scope </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daq</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path0</span><span class="p">)</span></div>
<span class="c1"># -----------------------------------------------------------------------------------------------------------   </span>

    <span class="c1"># Function to calculate the reference power</span>

<div class="viewcode-block" id="MainWindow.calculatePower"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.calculatePower">[docs]</a>    <span class="k">def</span> <span class="nf">calculatePower</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_df</span><span class="p">,</span> <span class="n">cal_df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to calculate power.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ref_df: DataFrame, required</span>
<span class="sd">            DataFrame of reference measurements</span>
<span class="sd">        cal_df: DataFrame, required</span>
<span class="sd">            DataFrame of reference calibration measurements</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            DataFrame of reference diode measurements incl. power</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">cal_wave_dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Create an empty dictionary</span>
        <span class="n">power</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Create an empty list</span>
            
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cal_df</span><span class="p">[</span><span class="s1">&#39;Wavelength [nm]&#39;</span><span class="p">])):</span> <span class="c1"># Iterate through columns of calibration file</span>
            <span class="n">cal_wave_dict</span><span class="p">[</span><span class="n">cal_df</span><span class="p">[</span><span class="s1">&#39;Wavelength [nm]&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cal_df</span><span class="p">[</span><span class="s1">&#39;Responsivity [A/W]&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="c1"># Add wavelength and corresponding responsivity to dictionary</span>


        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">])):</span> <span class="c1"># Iterate through columns of reference file</span>
<span class="c1">#            print(ref_df[&#39;Wavelength&#39;][y])</span>
            <span class="k">if</span> <span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cal_wave_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># Check if reference wavelength is in calibraton file</span>
                <span class="n">power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Mean Current&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">cal_wave_dict</span><span class="p">[</span><span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">]]))</span> <span class="c1"># Add power to the list</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># If reference wavelength is not in calibration file</span>
                <span class="n">resp_int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">],</span> <span class="n">cal_df</span><span class="p">[</span><span class="s1">&#39;Wavelength [nm]&#39;</span><span class="p">],</span> <span class="n">cal_df</span><span class="p">[</span><span class="s1">&#39;Responsivity [A/W]&#39;</span><span class="p">])</span> <span class="c1"># Interpolate responsivity</span>
                <span class="n">power</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Mean Current&#39;</span><span class="p">][</span><span class="n">y</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">resp_int</span><span class="p">))</span> <span class="c1"># Add power to the list                </span>
                
        <span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Power&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span> <span class="c1"># Create new column in reference file</span>
        
        <span class="k">return</span> <span class="n">ref_df</span><span class="p">[</span><span class="s1">&#39;Power&#39;</span><span class="p">]</span>        </div>
    
    <span class="c1"># Function to interpolate values    </span>
        
<div class="viewcode-block" id="MainWindow.interpolate"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.interpolate">[docs]</a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>     
        <span class="n">f</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">num</span><span class="p">)</span></div>
        
<span class="c1"># -----------------------------------------------------------------------------------------------------------   </span>
            
<div class="viewcode-block" id="MainWindow.set_up_plot"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.set_up_plot">[docs]</a>    <span class="k">def</span> <span class="nf">set_up_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to set up plot.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    
        <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#        plt.xlabel(&#39;Time (s)&#39;, fontsize=17, fontweight=&#39;medium&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R component (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>              
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#        plt.box()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Demodulator data&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.edgecolor&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#        plt.xlabel(&#39;Time (s)&#39;, fontsize=17, fontweight=&#39;medium&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log(R)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>              
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#        plt.box()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.edgecolor&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span> <span class="o">=</span> <span class="n">fig1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength [nm]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Phase&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#        plt.box()</span>
<span class="c1">#        plt.title(&#39;Demodulator data&#39;, fontsize=17, fontweight=&#39;medium&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.edgecolor&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">fig1</span></div>

<div class="viewcode-block" id="MainWindow.pause"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.pause">[docs]</a>    <span class="k">def</span> <span class="nf">pause</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to pause matplotlib without plt.show()</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interval: int, required</span>
<span class="sd">            Pause time</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is a reimplementation of the matplotlib pause function, removing the final show() call.</span>
<span class="sd">        It prevents the matplotlib plot window to pop up after each measurement.</span>
<span class="sd">        </span>
<span class="sd">        The matplotlib 3.6 docstring says: </span>
<span class="sd">        </span>
<span class="sd">        &quot;Run the GUI event loop for *interval* seconds.</span>
<span class="sd">        If there is an active figure, it will be updated and displayed before the</span>
<span class="sd">        pause, and the GUI event loop (if any) will run during the pause.</span>
<span class="sd">        This can be used for crude animation.  For more complex animation use</span>
<span class="sd">        :mod:`matplotlib.animation`.</span>
<span class="sd">        If there is no active figure, sleep for *interval* seconds instead.</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.animation : Proper animations</span>
<span class="sd">        show : Show all figures and optional block until all figures are closed.&quot;</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">_pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">get_active</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">manager</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">canvas</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">canvas</span>
            <span class="k">if</span> <span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">stale</span><span class="p">:</span>
                <span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
            <span class="c1">#show(block=False)</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">start_event_loop</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span></div>

<span class="c1"># -----------------------------------------------------------------------------------------------------------   </span>
        
<div class="viewcode-block" id="MainWindow.naming"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.naming">[docs]</a>    <span class="k">def</span> <span class="nf">naming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">path_name</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to compile filename.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_name: str, required</span>
<span class="sd">            File name</span>
<span class="sd">        path_name: str, required</span>
<span class="sd">            Path name</span>
<span class="sd">        num: str, required</span>
<span class="sd">            Filter number</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="n">exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">exists</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">num</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
            <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">naming</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">path_name</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span></div>

<span class="c1"># -----------------------------------------------------------------------------------------------------------   </span>

<div class="viewcode-block" id="MainWindow.HandleStopCompleteScanButton"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.HandleStopCompleteScanButton">[docs]</a>    <span class="k">def</span> <span class="nf">HandleStopCompleteScanButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to stop multi-filter measurement.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuring</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">imageCompleteScan_stop</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">&quot;Button_on.png&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">measuring</span></div>

<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="MainWindow.get_logger"><a class="viewcode-back" href="../sEQE.html#sEQE.MainWindow.get_logger">[docs]</a>    <span class="k">def</span> <span class="nf">get_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to set up logger.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        logger</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
                                      <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> - %H:%M:%S&quot;</span><span class="p">)</span>
        <span class="n">console</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    
<span class="c1">#        logfile = logging.FileHandler(&#39;run.log&#39;, &#39;w&#39;)</span>
<span class="c1">#        logfile.setLevel(logging.DEBUG)</span>
<span class="c1">#        logfile.setFormatter(formatter)</span>
    
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console</span><span class="p">)</span>
<span class="c1">#        logger.addHandler(logfile)</span>
    
        <span class="k">return</span> <span class="n">logger</span></div></div>

<span class="c1"># -----------------------------------------------------------------------------------------------------------</span>
        
<div class="viewcode-block" id="main"><a class="viewcode-back" href="../sEQE.html#sEQE.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">monoUI</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
        <span class="n">monoUI</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
        
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Unexpected error during main function: &quot;</span><span class="p">)</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span> 
    <span class="n">main</span><span class="p">()</span>
  

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Anna Jungbluth.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #244694; <!-- #F3631D -->
    }
    /* Sidebar */
    .wy-nav-side {
      background: #ffe95b; <!-- #343131 -->
    }
    
    /* Sidebar text */ 
    .wy-nav-side a {
    color: #818181;
    }
    
  </style>


</body>
</html>